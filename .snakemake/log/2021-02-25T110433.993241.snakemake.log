Building DAG of jobs...
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	aggregate_hrdetect_components
	1	all
	3	combine_scores
	3	hrd_scores
	1	hrdetect_component_paths
	1	hrdetect_output_table
	10

rule hrd_scores:
    input: data/example/patients/patient1/sample1/segments.tsv
    output: output/example/patients/patient1/sample1/hrd_scores/hrd_score.tsv
    jobid: 13
    wildcards: project=example, patient=patient1, sample=sample1

Rscript scripts/hrdscore/run_test.R -l data/example/patients/patient1/sample1/segments.tsv -o output/example/patients/patient1/sample1/hrd_scores/hrd_score.tsv --genome hg19 --hrdtools=git/hrdtools
Finished job 13.
1 of 10 steps (10%) done

rule hrd_scores:
    input: data/example/patients/patient3/sample1/segments.tsv
    output: output/example/patients/patient3/sample1/hrd_scores/hrd_score.tsv
    jobid: 15
    wildcards: project=example, patient=patient3, sample=sample1

Rscript scripts/hrdscore/run_test.R -l data/example/patients/patient3/sample1/segments.tsv -o output/example/patients/patient3/sample1/hrd_scores/hrd_score.tsv --genome hg19 --hrdtools=git/hrdtools
Finished job 15.
2 of 10 steps (20%) done

rule hrd_scores:
    input: data/example/patients/patient2/sample1/segments.tsv
    output: output/example/patients/patient2/sample1/hrd_scores/hrd_score.tsv
    jobid: 7
    wildcards: project=example, patient=patient2, sample=sample1

Rscript scripts/hrdscore/run_test.R -l data/example/patients/patient2/sample1/segments.tsv -o output/example/patients/patient2/sample1/hrd_scores/hrd_score.tsv --genome hg19 --hrdtools=git/hrdtools
Finished job 7.
3 of 10 steps (30%) done

rule combine_scores:
    input: output/example/patients/patient2/sample1/sv_signatures/sv_signit_exposure_summary.tsv, output/example/patients/patient2/sample1/indel_microhomology/microhomology_scores.tsv, output/example/patients/patient2/sample1/snv_signatures/signit_exposure_summary.tsv, output/example/patients/patient2/sample1/hrd_scores/hrd_score.tsv
    output: output/example/patients/patient2/sample1/hrdetect_components.tsv
    jobid: 4
    wildcards: project=example, patient=patient2, sample=sample1

 Rscript scripts/hrdetect/aggregate_scores.R -p patient2 -s sample1 --hrd output/example/patients/patient2/sample1/hrd_scores/hrd_score.tsv --snv output/example/patients/patient2/sample1/snv_signatures/signit_exposure_summary.tsv --sv output/example/patients/patient2/sample1/sv_signatures/sv_signit_exposure_summary.tsv --mh output/example/patients/patient2/sample1/indel_microhomology/microhomology_scores.tsv --out output/example/patients/patient2/sample1/hrdetect_components.tsv 
Finished job 4.
4 of 10 steps (40%) done

rule combine_scores:
    input: output/example/patients/patient3/sample1/sv_signatures/sv_signit_exposure_summary.tsv, output/example/patients/patient3/sample1/indel_microhomology/microhomology_scores.tsv, output/example/patients/patient3/sample1/snv_signatures/signit_exposure_summary.tsv, output/example/patients/patient3/sample1/hrd_scores/hrd_score.tsv
    output: output/example/patients/patient3/sample1/hrdetect_components.tsv
    jobid: 6
    wildcards: project=example, patient=patient3, sample=sample1

 Rscript scripts/hrdetect/aggregate_scores.R -p patient3 -s sample1 --hrd output/example/patients/patient3/sample1/hrd_scores/hrd_score.tsv --snv output/example/patients/patient3/sample1/snv_signatures/signit_exposure_summary.tsv --sv output/example/patients/patient3/sample1/sv_signatures/sv_signit_exposure_summary.tsv --mh output/example/patients/patient3/sample1/indel_microhomology/microhomology_scores.tsv --out output/example/patients/patient3/sample1/hrdetect_components.tsv 
Finished job 6.
5 of 10 steps (50%) done

rule combine_scores:
    input: output/example/patients/patient1/sample1/sv_signatures/sv_signit_exposure_summary.tsv, output/example/patients/patient1/sample1/indel_microhomology/microhomology_scores.tsv, output/example/patients/patient1/sample1/snv_signatures/signit_exposure_summary.tsv, output/example/patients/patient1/sample1/hrd_scores/hrd_score.tsv
    output: output/example/patients/patient1/sample1/hrdetect_components.tsv
    jobid: 5
    wildcards: project=example, patient=patient1, sample=sample1

 Rscript scripts/hrdetect/aggregate_scores.R -p patient1 -s sample1 --hrd output/example/patients/patient1/sample1/hrd_scores/hrd_score.tsv --snv output/example/patients/patient1/sample1/snv_signatures/signit_exposure_summary.tsv --sv output/example/patients/patient1/sample1/sv_signatures/sv_signit_exposure_summary.tsv --mh output/example/patients/patient1/sample1/indel_microhomology/microhomology_scores.tsv --out output/example/patients/patient1/sample1/hrdetect_components.tsv 
Finished job 5.
6 of 10 steps (60%) done

rule hrdetect_component_paths:
    input: output/example/patients/patient1/sample1/hrdetect_components.tsv, output/example/patients/patient2/sample1/hrdetect_components.tsv, output/example/patients/patient3/sample1/hrdetect_components.tsv
    output: output/example/cohorts/all/hrdetect/hrdetect_input_table_paths.tsv
    jobid: 3
    wildcards: project=example, cohort=all

Finished job 3.
7 of 10 steps (70%) done

rule aggregate_hrdetect_components:
    input: output/example/cohorts/all/hrdetect/hrdetect_input_table_paths.tsv
    output: output/example/cohorts/all/hrdetect/hrdetect_input_table.tsv
    jobid: 2
    wildcards: project=example, cohort=all

Rscript scripts/basic-functions/row_bind_tables.R -i output/example/cohorts/all/hrdetect/hrdetect_input_table_paths.tsv -o output/example/cohorts/all/hrdetect/hrdetect_input_table.tsv
Finished job 2.
8 of 10 steps (80%) done

rule hrdetect_output_table:
    input: output/example/cohorts/all/hrdetect/hrdetect_input_table.tsv
    output: output/example/cohorts/all/hrdetect/hrdetect_output_table.tsv
    log: output/example/cohorts/all/hrdetect/hrdetect_output_table.tsv
    jobid: 1
    wildcards: project=example, cohort=all

Rscript scripts/hrdetect/compute_hrdetect.R -i output/example/cohorts/all/hrdetect/hrdetect_input_table.tsv -o output/example/cohorts/all/hrdetect/hrdetect_output_table.tsv
Finished job 1.
9 of 10 steps (90%) done

localrule all:
    input: output/example/cohorts/all/hrdetect/hrdetect_output_table.tsv
    jobid: 0

Finished job 0.
10 of 10 steps (100%) done
